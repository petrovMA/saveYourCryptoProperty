<!DOCTYPE html>
<html>
<head>
  <title>Save Your Tezos property</title>
  <!--<meta name="viewport" content="width=device-width, initial-scale=1">-->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

  <script src="./libs/jquery-3.1.1.slim.min.js"></script>
  <script src="./libs/eztz.min.js"></script>
  <script src="./libs/tezos.js"></script>
</head>
<body class="container">
<div id="alerts"></div>
<div>Your account <strong><span id="account"></span></strong> has balance: <strong><span id="balance"></span></strong> êœ©
</div>
<br>
<br>
<div class="container" id="blockchain">
  <div class="form-group">
    <label for="contract">Contract address:</label>
    <input type="text" class="form-control" id="contract">
  </div>
  <h2>Unlock by:</h2>
  <div class="dropdown">
    <button type="button" class="btn btn-info dropdown-toggle" data-toggle="dropdown" id="dropdown-unlock">
      Mnemonic phrase
    </button>
    <div class="dropdown-menu">
      <a class="dropdown-item" href="#">Mnemonic phrase</a>
      <a class="dropdown-item" href="#">Private key</a>
    </div>
  </div>
  <div id="mnem">
    <div class="form-group">
      <label for="phrase">Mnemonic phrase:</label>
      <input type="text" class="form-control" id="phrase">
    </div>
    <div class="form-group">
      <label for="password">Password:</label>
      <input type="password" class="form-control" id="password">
      <label for="password-id"><span>Show Password</span></label>
      <input type="checkbox" onclick="hide('password')" id="password-id" checked>
    </div>

    <a href="#" onclick="balanceByPhrase()" class="btn btn-primary">Show Balance</a>
    <a href="#" onclick="pingContractByPhrase()" class="btn btn-primary">Ping</a>
    <a href="#" onclick="receivePropertyByPhrase()" class="btn btn-primary">Receive</a>
  </div>

  <div id="keys">
    <div class="form-group">
      <label for="key">Key:</label>
      <input type="password" class="form-control" id="key">
      <label for="key-id"><span>Show Key</span></label>
      <input type="checkbox" onclick="hide('key')" id="key-id" checked>
    </div>

    <a href="#" onclick="balanceByKey()" class="btn btn-primary">Show Balance</a>
    <a href="#" onclick="pingContractByKey()" class="btn btn-primary">Ping</a>
    <a href="#" onclick="receivePropertyByKey()" class="btn btn-primary">Receive</a>
  </div>
</div>
<script>
  function balanceByPhrase () {
    balance(getKeysByPhrase(document.getElementById('phrase').value, document.getElementById('password').value), document.getElementById('contract').value)
  }

  function pingContractByPhrase () {
    pingContract(getKeysByPhrase(document.getElementById('phrase').value, document.getElementById('password').value), document.getElementById('contract').value)
  }

  function receivePropertyByPhrase () {
    receiveProperty(getKeysByPhrase(document.getElementById('phrase').value, document.getElementById('password').value), document.getElementById('contract').value)
  }

  function balanceByKey () {
    balance(getKeysByKey(document.getElementById('key').value), document.getElementById('contract').value)
  }

  function pingContractByKey () {
    pingContract(getKeysByKey(document.getElementById('key').value), document.getElementById('contract').value)
  }

  function receivePropertyByKey () {
    receiveProperty(getKeysByKey(document.getElementById('key').value), document.getElementById('contract').value)
  }

  function hide (psswdId) {
    let box = document.getElementById(psswdId)
    if (document.getElementById(psswdId + '-id').checked === true) {
      box.type = 'text'
    } else {
      box.type = 'password'
    }
  }

  $('.dropdown-menu').on('click', 'a', function () {
    let text = $(this).html()
    let htmlText = text + ' <span class="caret"></span>'
    if (htmlText.startsWith('Mnemonic phrase')) {
      document.getElementById('keys').style.display = 'none'
      document.getElementById('mnem').style.display = 'block'
    } else {
      document.getElementById('keys').style.display = 'block'
      document.getElementById('mnem').style.display = 'none'
    }
    $(this).closest('.dropdown').find('.dropdown-toggle').html(htmlText)
  })

  $(function () {
    document.getElementById('keys').style.display = 'none'
    document.getElementById('mnem').style.display = 'block'
  })

</script>
</body>
</html>
